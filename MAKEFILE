# –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º .env –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é
ENV_FILE ?= .env

# –ö–æ–º–∞–Ω–¥—ã

up:
	@echo "üì¶ –ó–∞–ø—É—Å–∫ docker-compose..."
	docker compose --env-file $(ENV_FILE) up --build

down:
	@echo "üõë –û—Å—Ç–∞–Ω–æ–≤–∫–∞ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤..."
	docker compose down

logs:
	@echo "üìã –õ–æ–≥–∏ –≤—Å–µ—Ö –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤:"
	docker compose logs -f

restart:
	@echo "üîÑ –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤..."
	docker compose down && docker compose --env-file $(ENV_FILE) up --build

shell:
	@echo "üíª –í—Ö–æ–¥ –≤ flask-app shell..."
	docker exec -it flask-app bash

ps:
	docker compose ps

prune:
	@echo "üßπ –£–¥–∞–ª–µ–Ω–∏–µ –Ω–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º—ã—Ö —Ç–æ–º–æ–≤, —Å–µ—Ç–µ–π –∏ –æ–±—Ä–∞–∑–æ–≤..."
	docker system prune -f

# –¢–æ–ª—å–∫–æ –±–∞–∑–∞
db-shell:
	docker exec -it postgres psql -U postgres -d mydb
